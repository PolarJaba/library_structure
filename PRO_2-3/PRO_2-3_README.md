## Задание 

Руководство библиотеки решило усовершенствовать систему выдачи фонда и учитывать книги, которые берут читатели, но не сдают или попросту теряют.

1. Доработать структуру БД «Библиотека» на предмет хранения дополнительной информации о книгах, которые были утеряны. Информация о потерянных книгах должна содержать:

  -книга, которая была утеряна
  
  -дата потери
  
  -читатель, который потерял книгу.

2. Напишите sql запрос, который определяет, терял ли определенный читатель книги.

3. При потере книг количество доступных книг фонда меняется. Напишите sql запрос на обновление соответствующей информации.

4. Определить сумму потерянных книг по каждому кварталу в течение года.

Дополнительная информация к заданию:  

Книга считается на руках, если не указана дата возврата книги.

Должником является читатель, который не возвратил книгу в течение 2-х недель.

Книга считается прочитанной, если она была взята и сдана.

## Решение

1. [ddl-скрипт](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/ddl/lib_phys_system.sql) для создания БД доработан добавлением атрибута returned (boolean) к таблице book.

SQL-запросы для пунктов 2-4 расположены в файле [answers.sql](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/dml/answers.sql)

2. Написан запрос для вывода количества потерянных книг различными читателями, комментарии по изменению запроса для вывода только одного конкретного читателя указаны в [answers.sql](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/dml/answers.sql).

  В результате получена таблица:

  ![2nd_all_readers](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/2nd_all_readers.PNG)

3. Написан запрос для обновления таблицы book с изменением количества книг в фонде  учетом утерянных:

  ![upd](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/upd_test_table.PNG)

4. Определена сумма (количество и общая стоимость) потерянных книг за каждый квартал, в [answers.sql](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/dml/answers.sql) представлено решение только для конкретного года, а также для всех лет.

Таблица для всех лет ведения учета:

  ![4th](https://github.com/PolarJaba/library_structure/blob/main/PRO_2-3/4th-2v.PNG)


